(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{6429:function(t,e,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return a(9286)}])},7915:function(t,e,a){"use strict";a.d(e,{TX:function(){return r},lq:function(){return i},me:function(){return o},pH:function(){return n}});let n=async(t,e)=>{try{let a=await fetch("https://api.satria-wisata.com/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({RequestParameter:{email:t,password:e},SecretKey:"SAT123SU77",APPS:"satriaweb"})});if(!a.ok)throw Error("Login failed");let n=await a.json(),r=Date.now()+1e3*n.expires_in;return sessionStorage.setItem("token",n.token),sessionStorage.setItem("expires_at",r.toString()),n}catch(t){throw Error("Login failed")}},r=async()=>{try{sessionStorage.removeItem("token"),sessionStorage.removeItem("expires_at")}catch(t){throw Error("Logout failed")}},o=async()=>{let t=sessionStorage.getItem("token");try{let e=await fetch("https://api.satria-wisata.com/api/auth/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("Failed to fetch user data");return(await e.json()).name}catch(t){throw Error("Login failed")}},i=async()=>{let t=sessionStorage.getItem("token");try{let e=await fetch("https://api.satria-wisata.com/api/auth/me",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("Failed to fetch user data");let a=await e.json();return console.log(a),a}catch(t){throw Error("Login failed")}}},4228:function(t,e){"use strict";let a=async()=>{let t=sessionStorage.getItem("token");if(!t){window.location.href="/login";return}try{let e=await fetch("https://api.satria-wisata.com/api/faktur/getalldata",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("Failed to fetch user data");let a=await e.json();return localStorage.setItem("DataFaktur",JSON.stringify(a)),a}catch(t){throw Error("Fetch Failed")}};e.Z=a},2976:function(t,e,a){"use strict";a.r(e);var n=a(5893),r=a(7294),o=a(2757),i=a.n(o),s=a(852);e.default=t=>{let{onLogin:e}=t,[a,o]=(0,r.useState)(""),[c,l]=(0,r.useState)("");return(0,n.jsxs)("div",{className:i().card,children:[(0,n.jsx)("div",{className:i().logoimg,children:(0,n.jsx)(s.default,{})}),(0,n.jsxs)("div",{className:i().inputContainer,children:[(0,n.jsx)("label",{children:"Email:"}),(0,n.jsx)("input",{type:"email",value:a,onChange:t=>{o(t.target.value)},className:i().input})]}),(0,n.jsxs)("div",{className:i().inputContainer,children:[(0,n.jsx)("label",{children:"Password:"}),(0,n.jsx)("input",{type:"password",value:c,onChange:t=>{l(t.target.value)},className:i().input})]}),(0,n.jsx)("button",{className:i().button,onClick:()=>{e(a,c)},children:"Login"})]})}},852:function(t,e,a){"use strict";a.r(e);var n=a(5893);a(7294),e.default=()=>(0,n.jsx)("div",{children:(0,n.jsx)("img",{src:"/assets/images/logosatria.png",alt:"logo",style:{height:"10vh"}})})},9286:function(t,e,a){"use strict";a.r(e);var n=a(5893);a(7294);var r=a(2976),o=a(3613),i=a.n(o);a(4228);var s=a(7915),c=a(1163);e.default=()=>{let t=(0,c.useRouter)(),e=()=>{t.push("/")},a=async(t,a)=>{try{await (0,s.pH)(t,a),e()}catch(t){console.error("Login failed:",t),alert("Incorrect Email or Password")}};return(0,n.jsx)("div",{className:i().mainContainer,children:(0,n.jsx)(r.default,{onLogin:a})})}},2757:function(t){t.exports={card:"LoginCard_card__hUDc0",inputContainer:"LoginCard_inputContainer__e0m65",input:"LoginCard_input__x7tIU",button:"LoginCard_button__m5T9R",logoimg:"LoginCard_logoimg__p316a",list:"LoginCard_list__H1shc",listItem:"LoginCard_listItem__wSR9j"}},3613:function(t){t.exports={mainContainer:"Login_mainContainer__qBq__"}},1163:function(t,e,a){t.exports=a(9090)}},function(t){t.O(0,[888,774,179],function(){return t(t.s=6429)}),_N_E=t.O()}]);